---
layout: oneColumn
---

<div class="w-full grid grid-cols-1 md:grid-cols-2 gap-x-4">
  <div class="col-span-1" id="audio-player">
    <div class="">
      <div class="w-full">
        <img
          data-amplitude-song-info="cover_art_url"
          title="{{media.title}}"
          alt="{{media.title}}"
          class="rounded-sm mx-auto"
        />
        <div class="py-2">
          <progress
            class="amplitude-song-played-progress"
            id="song-played-progress"
          ></progress>
        </div>
      </div>
      <div class="grid grid-cols-1 gap-y-4" id="player-controls">
        <div class="flex gap-20 items-center justify-center justify-items-center py-8">
          <div class="col-span-1" id="playButton">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="w-20 h-20 fill-current"><!--! Font Awesome Pro 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --><path d="M512 256c0 141.4-114.6 256-256 256S0 397.4 0 256S114.6 0 256 0S512 114.6 512 256zM188.3 147.1c-7.6 4.2-12.3 12.3-12.3 20.9V344c0 8.7 4.7 16.7 12.3 20.9s16.8 4.1 24.3-.5l144-88c7.1-4.4 11.5-12.1 11.5-20.5s-4.4-16.1-11.5-20.5l-144-88c-7.4-4.5-16.7-4.7-24.3-.5z"/></svg>
          </div>
          <div id="pauseButton" class="hidden col-span-1">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="w-20 h-20 fill-current"><!--! Font Awesome Pro 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --><path d="M256 512c141.4 0 256-114.6 256-256S397.4 0 256 0S0 114.6 0 256S114.6 512 256 512zM224 192V320c0 17.7-14.3 32-32 32s-32-14.3-32-32V192c0-17.7 14.3-32 32-32s32 14.3 32 32zm128 0V320c0 17.7-14.3 32-32 32s-32-14.3-32-32V192c0-17.7 14.3-32 32-32s32 14.3 32 32z"/></svg>
          </div>
          <div class="col-span-1" id="downloadButton">
            <a
              href="{{site.mediaFilesUrl}}{{media.content}}"
              title="{{media.title}}"
              class="mid-gray"
              alt="Download"
              download
              >
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="w-20 h-20 fill-current"><!--! Font Awesome Pro 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --><path d="M256 0C114.6 0 0 114.6 0 256S114.6 512 256 512s256-114.6 256-256S397.4 0 256 0zM244.7 395.3l-112-112c-4.6-4.6-5.9-11.5-3.5-17.4s8.3-9.9 14.8-9.9l64 0 0-96c0-17.7 14.3-32 32-32l32 0c17.7 0 32 14.3 32 32l0 96 64 0c6.5 0 12.3 3.9 14.8 9.9s1.1 12.9-3.5 17.4l-112 112c-6.2 6.2-16.4 6.2-22.6 0z"/></svg>
            </a>
          </div>
        </div>

        <div class="text-2xl font-bold text-center">
          <span class="amplitude-current-time"></span> /
          <span class="amplitude-duration-time"></span>
        </div>
        <div class="text-xl font-semibold text-center">
          <div class="mid-gray">
            <div data-amplitude-song-info="name" class="song-name fw6"></div>
            <div data-amplitude-song-info="artist"></div>
          </div>
        </div>

        {% if tags contains "podcast" %}
        <div class="text-xl font-semibold text-center">
          <h3 class="uppercase py-2">Subscribe to the podcast</h3>
          <div class="flex flex-auto items-center justify-center justify-items-center gap-x-4">
            {% for podcastItem in podcast.links %}
            <a
              href="{{podcastItem.url}}"
              target="_blank"
              rel="noopener"
              class="block"
              ><img
                src="{{podcastItem.icon}}"
                class="w-10 h-10 rounded-sm"
            /></a>
            {% endfor %}
          </div>

        </div>
        {% endif %}
      </div>
    </div>
  </div>

  <div class="col-span-1">
    {% if media.tracklist %}
    <h3 class="text-xl font-semibold text-center uppercase">Tracklist</h3>
    <ol class="space-y-2">
      {% for tracklist in media.tracklist %}
      <li class="text-base font-medium py-2 px-2">{{tracklist}}</li>
      {% endfor %}
    </ol>
    {% endif %}
  </div>
</div>

<div class="prose prose-xl mx-auto">
  {% include partials/content.liquid content: content %}
</div>

<script>
  let isPlaying = false;
  const playButton = document.getElementById('playButton');
  const pauseButton = document.getElementById('pauseButton');

  const showAudioButtons = (playing = true) => {
    playButton.classList.toggle('hidden');
    pauseButton.classList.toggle('hidden');
  };

  const audioFinishedPlaying = () => {
    isPlaying = false;
    showAudioButtons(isPlaying);
  };

  {% if media.title %}
  const mediaTitle = '{{media.title}}';
  {% else %}
  const mediaTitle = null;
  {% endif %}
  const mediaAuthor = '{{media.author}}';
  const mediaImage = '{{media.image}}';
  const options = {
    songs: [
      {
        name: mediaTitle || '{{title | escape}}',
        artist: mediaAuthor || 'DJ Cruze',
        url: '{{site.mediaFilesUrl}}{{media.content}}',
        cover_art_url: mediaImage || '/images/mixes/dj-cruze-mix-logo-600x600.jpg',
      },
    ],
    callbacks: {
      stop: audioFinishedPlaying,
    },
  };
  Amplitude.init(options);

  // Handle a click on the song played progress bar.
  document
    .getElementById('song-played-progress')
    .addEventListener('click', function (event) {
      const offset = this.getBoundingClientRect();
      const x = event.pageX - offset.left;

      Amplitude.setSongPlayedPercentage(
        (parseFloat(x) / parseFloat(this.offsetWidth)) * 100
      );
    });

  const togglePlaying = () =>{
    if (!isPlaying) {
      Amplitude.play();
      isPlaying = true;
    } else {
      Amplitude.pause();
      isPlaying = false;
    }
    showAudioButtons(isPlaying);
  };

  // TODO: Add touch handler?
  playButton.addEventListener('click', togglePlaying);
  pauseButton.addEventListener('click', togglePlaying);
</script>
